{% extends 'base.html' %}

{% block main %}
<div class="jumbotron" style="align: left">
 <h1>{{ topic.get('label')|safe }}</h1>
 <a href="http://craigmod.com/journal/post_artifact/"><img src="{{ url_for('static', filename='img/post-artifact-books-publishing.png') }}"
     class="pull-right img-thumbnail"></a>
 <p class="lead">
   {{ topic.get('description')|safe }}
 </p>
 <div class="btn-group-vertical btn-group-lg">
   <a href="#book-sys-dlg" 
   class="btn btn-warning" 
   data-toggle="modal">Classic Publishing System for the Book</a>
   <a href="#book-post-dlg"
	  class="btn btn-default" 
      data-toggle="modal">The Book in the Post-Artifact System</a>
 </div>
</div>

<hr>

<div class="row">
 
 <div class="col-md-12">
  <h2>Questions about features &amp; functions?</h2>
  <ul>
   <li>How will the system support different and restricted copyrights?</li> 
   <li><a href="http://www.idpf.org/epub/30/spec/">ePub3</a> streams</li>
   <li>Professional and amateur annotations</li>
  </ul>
 </div>

</div>
 

<div class="row">
  <div class="col-md-12">
   <div class="btn-group pull-right"> 
    <a href="{{ url_for('slide', slide='discovery-elsewhere-local-needed') }}" class="btn btn-success btn-lg">
       Discovery happens elsewhere&hellip;but local is needed more than ever
    <span class="glyphicon glyphicon-chevron-right"></span>
    </a>
   </div>
  </div>
</div>

{% endblock %}

{% block dialogs %}
<div class="modal fade" id="book-sys-dlg">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3 class="modal-title">The Future of the Book</h3>
		<h4 class="modal-title" data-bind="text: stepTitle"></h4>
      </div>
      <div class="modal-body">
	   <div class="row">
	     <div class="col-md-12">
          <div class="btn-group">
            <a href="#"
	       class="btn-warning btn"
	       data-bind="click: refreshView"><span class="glyphicon glyphicon-refresh"></span></a>
            <a href="#"
               class="btn-primary btn"
               data-bind="click: startPlayAll">
                       <span class="glyphicon glyphicon-play"></span>
            </a> 

          </div>	
      </div>
	</div>
	<div class="row">
	 <div class="col-md-8">
	   <div id="book-sys-animation"></div>
     </div>
     <div class="col-md-4">
      <ul data-bind="foreach: explanations">
       <li class="lead" data-bind="html: paragraph"></li>
      </ul>
      </div>
    </div>
   </div>
   <div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
   </div>
  </div> 
  </div><!-- /.modal-content -->
 </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div class="modal fade" id="book-post-dlg">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3 class="modal-title">The Book in the Post-Artifact System</h3>
      </div>
      <div class="modal-body">
        <div class="btn-group">
		 <a href="#" 
		    class="btn-primary btn disabled"
			><span class="glyphicon glyphicon-step-backward"></span></a>
		 <a href="#" 
		    class="btn-primary btn"
			><span class="glyphicon glyphicon-play"></span></a>
		 <a href="#" 
		    class="btn-primary btn"
			><span class="glyphicon glyphicon-step-forward"></span></a>
	</div>
          <div id="book-digital-animation"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{% endblock %}

{% block inline_js %}
<script src="//cdnjs.cloudflare.com/ajax/libs/svg.js/1.0rc3/svg.min.js"></script>
<script>

var AnimationControls = function(steps){
  var self = this;
  self.current_step = 0;
  self.steps = steps;
  
  self.backStep = function() {
    self.steps[self.current_step]();
    if(self.current_step <= 0) {
	  self.current_step=0;
    } else {
	  self.current_step -= 1;
	}
  }
  
  self.forwardStep = function() {
    self.steps[self.current_step]();
    if(self.current_step >= self.steps.length) {
	  self.current_step = self.steps.length -1;
	} else {
	  self.current_step += 1;
	}
  }
}


var BookAsSystemViewModel = function() {
 var self = this; 

 self.playAll = ko.observable(false);

 self.refreshView = function() {
  $('#book-sys-animation').empty();
  self.explanations.removeAll();
  self.initSVG();
 }

 self.stepTitle = ko.observable();

 self.startPlayAll = function() {
   self.playAll(true);
   self.showLinearArtifact();
 }
 
 self.initSVG = function() { 
   
	 self.svgDraw = SVG('book-sys-animation').size('800', '400');
	 
	 self.ideaGroup = self.svgDraw.group();
	 self.ideaGroup.add(self.svgDraw.text("Idea").font({ size: 18 }).move(-20,20).rotate(-45));
	 self.ideaGroup.add(self.svgDraw.line(10, 48, 10, 90).stroke({ width: 1 })); 
	 self.ideaGroup.y(100);
	 
	 self.preArtifactSystem = self.svgDraw.group();
	 self.preArtifactSystem.add(self.svgDraw.line(15, 70, 150, 70 ).stroke({ 'dasharray': '5,5', width: 1 }));
	 self.preArtifactSystem.add(self.svgDraw.text("pre-artifact system").font({ size: 16 }).move(15, 72));
	 self.preArtifactSystem.move(self.ideaGroup.x(), self.ideaGroup.y()) 


	 self.publisher = self.svgDraw.group();
	 self.publisher.add(self.svgDraw.text("publisher").font({ size: 16 }).rotate(45).move(10, 15));
	 self.publisher.add(self.svgDraw.line(45, 60, 45, 140).stroke({ width: 1 }));
	 self.publisher.move(110, 75);

	 self.printer = self.svgDraw.group();
	 self.printer.add(self.svgDraw.text("printer").font({ size: 16 }).rotate(45).move(15, 0));
	 self.printer.add(self.svgDraw.line(45, 45, 45, 165).stroke({ width: 1 }));
	 self.printer.move(120, 75);

	 self.greatArtifact = self.svgDraw.group();
	 self.greatArtifact.add(self.svgDraw.rect(150, 150).fill({ color: 'rgb(35,31,32)' }));
	 self.artifact_label = self.svgDraw.text(function(add) {
	   add.tspan("The Great").newLine()
	   add.tspan("Immutable").newLine()
	   add.tspan("Artifact").newLine()}).font({ size: 18, 'text-transform': 'uppercase' }).fill({ color: 'rgb(255,255,255)' });
	 self.artifact_label.move(-35,60).rotate(-45); 
	 self.greatArtifact.add(self.artifact_label);
	 self.greatArtifact.move(175, 100);

	 var start_x = self.greatArtifact.x() + self.greatArtifact.y();

	 self.distributor = self.svgDraw.group();
	 self.distributor.add(self.svgDraw.text("distributor").font({ size: 16 }).move(-5, 35).rotate(-45)); 
	 self.distributor.add(self.svgDraw.line(30, 45, 30, 165).stroke({ width: 1 }));
	 self.distributor.move(305, 75);
	 
	self.library = self.svgDraw.group();
	 self.library.add(self.svgDraw.text("library").font({ size: 16 }).move(-10, 60).rotate(-45)); 
	 self.library.add(self.svgDraw.line(35, 60, 35, 140).stroke({ width: 1 }));
	 self.library.move(310, 75);

	self.pushBook = self.svgDraw.group();
	self.pushBook.add(self.svgDraw.line(0, 10, 100, 10).stroke({ width: 3 }));
	self.pushBook.add(self.svgDraw.polygon('105,10 100,5 100,15').fill({ color: 'rgb(0,0,0)' }).stroke({ width: 2 }));
	self.pushBook.move(350, 160);

	self.readers = self.svgDraw.group();
	self.readersLabel = self.svgDraw.text("Readers").font({ size: 18, 'text-transform': 'uppercase' }).move(-15,40).rotate(-45);
	self.readers.add(self.readersLabel); 
	self.readers.add(self.svgDraw.rect(100, 50).fill('none').stroke({ 'dasharray': '5,5', width: 1 }).move(5,70));
	for(var i=0;i<50;i++) {
	  var rand_x = Math.floor(Math.random()*100);
	  if(rand_x < 5) { rand_x = 5; }
	  var rand_y = Math.floor(Math.random()*50) + 70;
	  if(rand_y > 115) { rand_y = 115; }
	  self.readers.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(rand_x,rand_y));
	}
	self.readers.move(455, 70);

	self.lightBlub = self.svgDraw.group();
	self.lightBlub.add(self.svgDraw.image("{{ url_for('static', filename='img/idea_64x64.png') }}"));
	self.lightBlub.move(450, 10);
	self.lightBlub.hide();

        self.hemingway = self.svgDraw.group();
        self.hemingway.add(self.svgDraw.image("http://upload.wikimedia.org/wikipedia/commons/thumb/2/28/ErnestHemingway.jpg/192px-ErnestHemingway.jpg"));
        self.hemingway.hide();

	self.manuscript = self.svgDraw.group();
	self.manuscript.add(self.svgDraw.image("{{ url_for('static', filename='img/creative_writing_64x64.png') }}"));
	self.manuscript.move(30, 250);
	self.manuscript.hide();

        self.wintour = self.svgDraw.group();
        self.wintour.add(self.svgDraw.image("{{ url_for('static', filename='img/anna-wintour.png') }}"));
        self.wintour.hide();
       
	self.printBook = self.svgDraw.group();
	self.printBook.add(self.svgDraw.image("{{ url_for('static', filename='img/print_book.png') }}"));
	self.printBook.move(0, 0);
	self.printBook.hide();

        self.printingPress = self.svgDraw.group();
        self.printingPress.add(self.svgDraw.image("http://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Hoe%27s_one_cylinder_printing_press.png/320px-Hoe%27s_one_cylinder_printing_press.png"));
        self.printingPress.hide();

	self.explainText = ko.observable();

	self.firstStep = self.svgDraw.group();
	self.firstStep.add(self.ideaGroup);
	self.firstStep.add(self.preArtifactSystem);
	self.notFirstStep = self.svgDraw.group();

	self.notFirstStep.add(self.printer);
	self.notFirstStep.add(self.publisher);
	self.notFirstStep.add(self.greatArtifact);
	self.notFirstStep.add(self.distributor);
	self.notFirstStep.add(self.library);
	self.notFirstStep.add(self.pushBook);  
	self.notFirstStep.add(self.readers);  

	self.explanations = ko.observableArray();

	self.secondStep = self.svgDraw.group();
	//self.secondStep.add(self.printer)
	//self.secondStep.add(self.publisher);
	self.notSecondStep = self.svgDraw.group();

	self.thirdStep = self.svgDraw.group();

	self.time = self.svgDraw.group();
	self.time.add(self.svgDraw.text("Time").font({ size: 18,
													'text-transform': 'uppercase'}).fill('rgb(0,0,255)'));
	self.time.add(self.svgDraw.line(45, 15, 550, 15).stroke({ width: 3, color: 'rgb(0,0,255)'}));
	self.time.add(self.svgDraw.polygon("545,10 545,20 550,15").fill({ color: 'rgb(0,0,255)' }).stroke({ width: 2, color: 'rgb(0,0,255)' }));
	self.time.move(10, 350);
}

self.initSVG();

 self.showLinearArtifact = function() {
  self.stepTitle("1. Author's idea and manuscript");
  self.explanations.push({'paragraph': "The traditional writer's workflow starts with the author's idea"})
  self.notFirstStep.animate().opacity(0.5).scale(0.5, 0.5).after(function() {
   self.firstStep.animate().scale(1.5, 1.5).move(250,-100).after(function() {
    self.lightBlub.scale(0.5, 0.5);
    self.lightBlub.move(155, 165);
    self.explanations.push({'paragraph': "The author may or may not have a contract with a publisher"});
    self.lightBlub.show();
    self.hemingway.move(150, 250);
    self.hemingway.show();
    self.lightBlub.animate().scale(0.75,0.75).after(function() {
      self.lightBlub.animate().opacity(1.0).after(function() {
       self.lightBlub.animate().opacity(0.5).loop();
       self.manuscript.move(210, 260);
       self.manuscript.show();
       self.manuscript.animate().opacity(1.0).after(function() {
         self.explanations.push({'paragraph': "The author writes a manuscript, traditionally in isolation, with few contacts with readers"});
         self.manuscript.animate(4000).x(450).after(function() {  
          self.explanations.push({'paragraph': "Special Collections and Archives typically collect manuscripts often using TEI and EAD to describe the collection"});
           if(self.playAll()) {
             self.publishBook();
           }
           self.lightBlub.hide();
           self.hemingway.animate().x(20).after(function() { 
             self.manuscript.x(90);
           });
         });
     });
    });
  });
 });
});
}


 self.publishBook = function() {
  self.stepTitle("2. Publishing & Printing");
  self.explanations.removeAll();
  self.explanations.push({'paragraph': 'After receiving the manuscript, the editor and publisher work on a print-ready book'});

  self.firstStep.animate().opacity(0.5).move(0,0).scale(0.5, 0.5).after(function() {
     self.secondStep.add(self.publisher);
     self.publisher.animate().scale(2.0, 2.0).opacity(1.0).after(function() {
     self.publisher.x(120);
     self.printer.move(250,75);
     self.secondStep.add(self.printer);
     self.printer.animate().scale(2.0, 2.0).after(function() {
      self.wintour.move(240, 250);
      self.wintour.show();
      self.printingPress.move(self.printer.x() + 110, 240);
      self.printingPress.show();
      self.manuscript.front();
      self.explanations.push({'paragraph': 'After a few drafts between the author and editor, a final draft is ready'});
      self.printBook.move(self.wintour.x() - 10, self.manuscript.y());
      var counter = 0;
      self.manuscript.animate().x(210).loop(3).after(function() { 
        if(!self.printBook.visible()) {
          self.manuscript.hide();
          self.printBook.show();
        }
        self.printBook.animate(2000, '>', 6000).move(450,
                                                     self.printBook.y()).after(function() {
         
         self.publisher.animate().opacity(0.5).scale(0.5, 0.5).after(function() { {# move(55, 40).#}
          self.publisher.move(55, 40);
          self.wintour.animate().opacity(0.1);
          self.printer.animate().opacity(0.5).scale(0.5, 0.5).move(60, 40).after(function() {
           self.hemingway.animate().opacity(0.1);

	    self.printBook.add(self.svgDraw.text("now becomes").font(
            { size: 32, 
              'text-transform': 'uppercase' }).move(80,25));
              self.printBook.animate().x(100).after(function() {
                if(self.playAll()) {
                  self.greatImmutableArtifact();
                }
                self.printingPress.hide(); 
                self.hemingway.hide();
                self.wintour.hide(); 
                self.printBook.hide();
              });
           });
	  });
	 });
        });
      });
    });
   });
 }

 self.greatImmutableArtifact = function() {
   self.stepTitle("3. The Great Immutable Artifact");
   self.explanations.removeAll();
   self.explanations.push({'paragraph': "Craig Mod calls the printed book, the <i>Great Immutable Artifact</i>"});
   self.thirdStep.add(self.greatArtifact);
   self.greatArtifact.animate().scale(1.5,1.5).after(function() {
     self.explanations.push({'paragraph': "A book, once printed, assumes a number of properties libraries are interested in"});
     self.artifact_label.animate().move(5,5).rotate(0).after(function() {
        var book_img = self.svgDraw.image("{{ url_for('static', filename='img/print_book.png') }}").scale(0.75, 0.75);
        book_img.move(50,79);
        self.greatArtifact.add(book_img);
        self.explanations.push({'paragraph': "RDA properties like ISBN, page numbers, illustrations"});
         console.log("Before playAll " + self.playAll());
         if(self.playAll()) {
              self.distributeAcquire();          
           } 
         });
   });
 }

 self.distributeAcquire = function() {
   self.stepTitle("4. Distribution & Acquisition");
   self.explanations.removeAll();
   self.forthStep = self.svgDraw.group();   
   
   self.greatArtifact.animate().opacity(0.5).scale(0.5, 0.5).move(90,45).after(function() {
     self.explanations.push({"paragraph": "After publication, the book is marketed by publisher"});
	 self.forthStep.add(self.distributor);
	 self.distributor.animate().scale(2.0, 2.0).opacity(1.0).x(100).after(function() {
	  var book_image = self.svgDraw.image("{{ url_for('static', filename='img/print_book.png') }}").scale(0.75, 0.75).hide().move(50, 200);
	  book_image.show();
	  self.forthStep.add(self.library);
	  self.library.animate().scale(2.0, 2.0).opacity(1.0).x(200).after(function() {
	   book_image.animate().x(200).after(function() {
	    self.explanations.push({"paragraph": "The publisher sends the Book to the distributor"}); 
	     book_image.animate().x(250).after(function() {
		  self.forthStep.add(book_image);
	      self.explanations.push({"paragraph": "The Library acquires the book, either through patron demand or collection policies"});
              if(self.playAll()) {
                self.pushToReaders();            
              }
	   });
	  });
	 });
	});
   });
   
 }
 
 self.pushToReaders = function() {
   self.forthStep.hide();
   self.stepTitle("5. Push Book to Readers");
   self.explanations.removeAll();
   self.explanations.push({'paragraph': "Book is made available to patrons after shelving in the library's stacks"});
   self.fifthStep = self.svgDraw.group()
   self.fifthStep.add(self.readers);
   self.readersLabel.rotate(0);
   self.readers.animate().scale(2.0, 2.0).move(300, 20).after(function() { 
      self.explanations.push({'paragraph': "Reader finds Book through the library's catalog or requests Book from collection"});
      
   });
 }
 
 self.controls = new AnimationControls([self.showLinearArtifact,
					  				    self.publishBook,
                                        self.greatImmutableArtifact,
									    self.distributeAcquire,
                                        self.pushToReaders]);
				
// Controls
  
 self.backIsActive = ko.observable('btn btn-primary disabled');
 
 self.backOne = function() {
   self.controls.backStep();
 }
 
 self.forwardOne = function() {
   if(self.controls.current_step != 0) {
     console.log("Should set back to default");
     self.backIsActive('btn btn-primary');
   }
   self.controls.forwardStep();
 }
 
 self.fowardIsActive = ko.computed(function() {
  var nav_classes = 'btn btn-primary';
  if(self.controls.current_step >= self.controls.steps.length) {
     nav_classes += ' disabled';
   }
   return nav_classes;
 }, self);
  
}


var BookPostArtifactSystemModel = function() {
 var self = this;
  
 self.backStep = function() { console.log("In backstep"); }
 self.forwardStep = function() { console.log("In forward step"); }
 self.playDigitalArtifact = function() { console.log("Play Digital Artifact Animation"); }
  
  
 self.svgDraw = SVG('book-digital-animation').size('1000', '600');

 self.ideaGroup = self.svgDraw.group();
 self.ideaGroup.add(self.svgDraw.text("Idea").font({ size: 18 }).move(-20,20).rotate(-45));
 self.ideaGroup.add(self.svgDraw.line(10, 48, 10, 90).stroke({ width: 1 })); 
 self.ideaGroup.y(200);
 
 self.preArtifactSystem = self.svgDraw.group();
 self.preArtifactSystem.add(self.svgDraw.line(15, 70, 155, 70 ).stroke({ 'dasharray': '5,5', width: 1 }));
 self.preArtifactSystem.add(self.svgDraw.text("pre-artifact system").font({ size: 16 }).move(15, 70));
 var rightArrow = self.svgDraw.group();
 rightArrow.add(self.svgDraw.polygon('118,25 125,20 118,18').fill({ color: 'rgb(0,0,0)' }).stroke({ width: 2 }));
 rightArrow.add(self.svgDraw.line(120, 20, 150, 65).stroke({ width: 3 }));
 //rightArrow.animate().move(rightArrow.x()-2, rightArrow.y()-2).loop();
 self.preArtifactSystem.add(rightArrow);
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(60, 5));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(50, 8));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(55, 15));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(65, 0));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(75, 25));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(75, -5));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(85, 10));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(90, -10));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(95, -1));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(92, 20));
 self.preArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(110, 2));
 var leftArrow = self.svgDraw.group();
 leftArrow.add(self.svgDraw.polygon('40,63 30,65 32,55').fill({ color: 'rgb(0,0,0)' }).stroke({ width: 2 }));
 leftArrow.add(self.svgDraw.line(35, 60, 65, 20).stroke({ width: 3 }));
 //leftArrow.animate().move(leftArrow.x()-1, leftArrow.y()-2).loop();
 self.preArtifactSystem.add(leftArrow);
 self.preArtifactSystem.move(self.ideaGroup.x(), self.ideaGroup.y()) 
 
 self.publisher_author = self.svgDraw.group();
 self.publisher_author.add(self.svgDraw.line(155, 40, 155, 150).stroke({ width: 1 }));
 self.publisher_author.add(self.svgDraw.text("publisher / author").font({ size: 14 }).move(50,-50).rotate(25));
 self.publisher_author.y(160);
 
 self.print = self.svgDraw.group();
 self.print.add(self.svgDraw.line(155, 70, 300, -30).stroke({ 'dasharray': '5,5', width: 1 }));
 self.print.add(self.svgDraw.text("Print").font({ size: 16, 
                                                  'text-transform': 'uppercase' }).rotate(-35).move(100,125));
 self.print.y(200);
 
 self.digital = self.svgDraw.group();
 self.digital.add(self.svgDraw.line(155, 70, 250, 130).stroke({ 'dasharray': '5,5', width: 1 }));
 self.digital.add(self.svgDraw.text("Digital").font({ size: 16, 
                                                    'text-transform': 'uppercase' }).rotate(34).move(180, -35));
 self.digital.y(200);
 
 self.immutableArtifact = self.svgDraw.group();
 self.immutableArtifact.add(self.svgDraw.rect(150, 150).fill({ color: 'rgb(35,31,32)' }));
 self.artifact_label = self.svgDraw.text(function(add) {
   add.tspan("The ")
   add.tspan("Great").fill('rgb(128,128,128)').attr({ 'text-decoration': 'line-through'}).newLine()
   add.tspan("Immutable").newLine()
   add.tspan("Artifact").newLine()}).font({ size: 18, 'text-transform': 'uppercase' }).fill({ color: 'rgb(255,255,255)' });
 self.artifact_label.move(-40,60).rotate(-45); 
 self.immutableArtifact.add(self.artifact_label);
 self.immutableArtifact.scale(0.85, 0.85).move(310, 100);
 
 self.printer = self.svgDraw.group();
 self.printer.add(self.svgDraw.text("printer").font({ size: 16 }).rotate(35).move(20, -10));
 self.printer.add(self.svgDraw.line(45, 45, 45, 145).stroke({ width: 1 }));
 self.printer.move(255, 75);
 
 self.distributionChannels = self.svgDraw.group();
 self.distributionChannels.add(self.svgDraw.text(function(add) {
   add.tspan("distributor,").newLine()
   add.tspan("author homepage,").newLine()
   add.tspan("amazon, etc").newLine()}).font({ size: 16 }).rotate(-35).y(80));
 self.distributionChannels.add(self.svgDraw.line(85, 110, 85, 210).stroke({ width: 1 }));
 self.distributionChannels.x(360) 
 
 self.digitalArtifact = self.svgDraw.group();
 self.digitalArtifact.add(self.svgDraw.text(function(add) {
    add.tspan("Digital").newLine()
 	add.tspan("Artifact").newLine()}).font({ size: 16,
	                                         weight: 'bold',
		  									 'text-transform': 'uppercase'}).rotate(-35));
 self.digitalArtifact.add(self.svgDraw.line(15, 20, 15, 120).stroke({ width: 3 }));
 self.digitalArtifact.move(240, 260);
 
 self.postArtifactSystem = self.svgDraw.group();
 self.postArtifactSystem.add(self.svgDraw.line(0, 15, 25, 15).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(20, 10, 25, 15).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(20, 20, 25, 15).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(25, 10));
 self.postArtifactSystem.add(self.svgDraw.line(30, 0, 30, 100).stroke({ width: 2,
																		color: "rgb(255,0,0)",
																		'dasharray': '2,2'}));
 self.postArtifactSystem.add(self.svgDraw.line(30, 30, 45, 30).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(40, 25, 45, 30).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(40, 35, 45, 30).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(45, 25));  
 self.postArtifactSystem.add(self.svgDraw.line(50, 0, 50, 100).stroke({ width: 2,
																		color: "rgb(255,0,0)",
																		'dasharray': '2,2'})); 
 self.postArtifactSystem.add(self.svgDraw.line(50, 45, 90, 45).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(85, 40, 90, 45).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(85, 50, 90, 45).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(90, 40));  
 self.postArtifactSystem.add(self.svgDraw.line(95, 0, 95, 100).stroke({ width: 2,
																		color: "rgb(255,0,0)",
																		'dasharray': '2,2'})); 
 self.postArtifactSystem.add(self.svgDraw.line(95, 60, 150, 60).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(145, 55, 150, 60).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(145, 65, 150, 60).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(150, 55));  
 self.postArtifactSystem.add(self.svgDraw.line(155, 0, 155, 100).stroke({ width: 2,
																		color: "rgb(255,0,0)",
																		'dasharray': '2,2'}));
 self.postArtifactSystem.add(self.svgDraw.line(155, 20, 170, 20).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(165, 15, 170, 20).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(165, 25, 170, 20).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(170, 15));  
 self.postArtifactSystem.add(self.svgDraw.line(175, 0, 175, 100).stroke({ width: 2,
																		color: "rgb(255,0,0)",
																		'dasharray': '2,2'}));
 self.postArtifactSystem.add(self.svgDraw.line(175, 85, 320, 85).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(315, 80, 320, 85).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.line(315, 90, 320, 85).stroke({ width: 2, color: "rgb(255,0,0)" }));
 self.postArtifactSystem.add(self.svgDraw.circle(10).fill({ color: 'rgb(255,0,0)' }).move(320, 80));  
 self.postArtifactSystem.add(self.svgDraw.line(325, 0, 325, 100).stroke({ width: 2,
																		color: "rgb(255,0,0)",
																		'dasharray': '2,2'}));
 self.postArtifactSystem.move(255, 280); 
 
 self.time = self.svgDraw.group();
 self.time.add(self.svgDraw.text("Time").font({ size: 18,
		  									    'text-transform': 'uppercase'}).fill('rgb(0,0,255)'));
 self.time.add(self.svgDraw.line(45, 15, 550, 15).stroke({ width: 3, color: 'rgb(0,0,255)'}));
 self.time.add(self.svgDraw.polygon("545,10 545,20 550,15").fill({ color: 'rgb(0,0,255)' }).stroke({ width: 2, color: 'rgb(0,0,255)' }));
 self.time.move(10, 420);
 
}

var book_sys_view_model =  BookAsSystemViewModel();
var book_digital_view_model = BookPostArtifactSystemModel();
ko.applyBindings(book_sys_view_model, document.getElementById('book-sys-dlg')); 
ko.applyBindings(book_digital_view_model, document.getElementById('book-post-dlg'));

</script>
{% endblock %}
